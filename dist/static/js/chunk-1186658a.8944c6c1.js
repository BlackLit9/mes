(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1186658a"],{"3e51":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-pagination",{attrs:{layout:"total,prev,pager,next",total:t.total,"page-size":t.pageSize,"current-page":t._currentPage},on:{"update:currentPage":function(e){t._currentPage=e},"update:current-page":function(e){t._currentPage=e},"current-change":t.currentChange}})],1)},r=[],n=(a("a9e3"),{props:{total:{type:Number,default:0},pageSize:{type:Number,default:10},currentPage:{type:Number,default:1}},data:function(){return{}},computed:{_currentPage:{get:function(){return this.currentPage},set:function(){return 1}}},methods:{currentChange:function(t){this.$emit("currentChange",t)}}}),l=n,i=a("2877"),o=Object(i["a"])(l,s,r,!1,null,null,null);e["a"]=o.exports},"624e":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"日期"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},on:{change:t.dayTimeChanged},model:{value:t.getParams.day_time,callback:function(e){t.$set(t.getParams,"day_time",e)},expression:"getParams.day_time"}})],1),a("el-form-item",{attrs:{label:"机台"}},[a("equip-select",{attrs:{equip_no_props:t.getParams.equip_no},on:{"update:equip_no_props":function(e){return t.$set(t.getParams,"equip_no",e)},changeSearch:t.equipSelected}})],1),a("el-form-item",{attrs:{label:"班次"}},[a("class-select",{on:{classSelected:t.classSelected}})],1),a("el-form-item",{attrs:{label:"胶料"}},[a("all-product-no-select",{on:{productBatchingChanged:t.productBatchingChanged}})],1),a("el-form-item",{attrs:{label:"处理意见"}},[a("deal-suggestion-select",{on:{dealSuggestionChange:t.dealSuggestionChange}})],1)],1),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["deal_result","print"],expression:"['deal_result','print']"}],staticStyle:{float:"right","margin-bottom":"10px"},on:{click:t.printingFun}},[t._v("打印")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{border:"",fit:"",data:t.palletFeedTestList,size:"mini"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"30"}}),a("el-table-column",{attrs:{type:"index",label:"No",width:"30"}}),a("el-table-column",{attrs:{align:"center",label:"生产信息"}},[a("el-table-column",{attrs:{label:"工厂日期",prop:"day_time",width:"80"}}),a("el-table-column",{attrs:{label:"收皮条码",prop:"lot_no"}}),a("el-table-column",{attrs:{label:"生产班次/班组",width:"60",align:"center",prop:"classes_group"}}),a("el-table-column",{attrs:{label:"生产机台",prop:"equip_no",width:"40"}}),a("el-table-column",{attrs:{label:"胶料编码",prop:"product_no"}}),a("el-table-column",{attrs:{label:"收皮重量",prop:"actual_weight",width:"40"}}),a("el-table-column",{attrs:{label:"余量",prop:"residual_weight",align:"center",width:"40"}}),a("el-table-column",{attrs:{label:"生产时间",width:"80",align:"center",prop:"production_factory_date"}}),a("el-table-column",{attrs:{label:"有效时间",width:"80",align:"center",prop:"valid_time"}})],1),a("el-table-column",{attrs:{label:"质量信息",align:"center"}},[a("el-table-column",{attrs:{label:"检测状态",align:"center",prop:"test.test_status",width:"45"}}),a("el-table-column",{attrs:{label:"检测时间",width:"80",align:"center",prop:"test.test_factory_date"}}),a("el-table-column",{attrs:{label:"检测班次",prop:"test.test_class",width:"45"}}),a("el-table-column",{attrs:{label:"打印时间",width:"80",align:"center",prop:"print_time"}}),a("el-table-column",{attrs:{label:"检测员",prop:"test.test_user",width:"60"}}),a("el-table-column",{attrs:{label:"检测结果",prop:"deal_result",width:"30"}}),a("el-table-column",{attrs:{label:"处理人",prop:"deal_user",width:"50"}}),a("el-table-column",{attrs:{label:"处理意见",prop:"deal_suggestion",width:"40"}}),a("el-table-column",{attrs:{label:"处理时间",align:"center",prop:"deal_time",width:"80"}})],1),a("el-table-column",{attrs:{label:"操作",align:"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[a("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.print(s)}}},[t._v("查看质量卡片")])]}}])})],1),a("page",{attrs:{total:t.total,"current-page":t.getParams.page},on:{currentChange:t.currentChange}}),a("el-dialog",{attrs:{title:"修改有效时间",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"dataForm",attrs:{model:t.formData,rules:t.rules,"label-position":"left","label-width":"110px"}},[a("el-form-item",{attrs:{label:"有效时间",prop:"valid_time"}},[a("el-input-number",{model:{value:t.formData.valid_time,callback:function(e){t.$set(t.formData,"valid_time",t._n(e))},expression:"formData.valid_time"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v(" 取消 ")]),a("el-button",{attrs:{type:"primary"},on:{click:t.updateData}},[t._v(" 确定 ")])],1)],1),a("el-dialog",{attrs:{fullscreen:!0,visible:t.testCardDialogVisible},on:{"update:visible":function(e){t.testCardDialogVisible=e}}},[a("test-card",{ref:"testCard"})],1)],1)},r=[],n=(a("4160"),a("159b"),a("96cf"),a("1da1")),l=a("5a0c"),i=a.n(l),o=a("3e51"),c=a("4090"),u=a("cfc4"),d=a("5dce"),_=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{"visible-change":t.visibleChange,change:t.change},model:{value:t.suggestion_desc,callback:function(e){t.suggestion_desc=e},expression:"suggestion_desc"}},t._l(t.suggestionOptions,(function(t,e){return a("el-option",{key:e,attrs:{label:t,value:t}})})),1)},p=[],g=a("b775"),m=a("99b1");function h(){return Object(g["a"])({url:m["a"].dealSuggestionView,method:"get"})}var b={data:function(){return{suggestion_desc:"",suggestionOptions:[]}},methods:{change:function(t){this.$emit("dealSuggestionChange",this.suggestion_desc)},getDealSuggestion:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,h();case 2:a=e.sent,t.suggestionOptions=a;case 4:case"end":return e.stop()}}),e)})))()},visibleChange:function(t){t&&this.getDealSuggestion()}}},f=b,v=a("2877"),D=Object(v["a"])(f,_,p,!1,null,null,null),w=D.exports,y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card-container"},[a("table",{staticClass:"info-table",attrs:{border:"1",bordercolor:"black"}},[a("tbody",[t._m(0),a("tr",[a("td",{attrs:{colspan:"4"}},[t._v(t._s(t.testData.product_no))]),t._m(1)]),a("tr",[a("td",[t._v("工厂日期")]),a("td",[t._v(t._s(t.testData.day_time))]),a("td",[t._v("生产班次")]),a("td",[t._v(t._s(t.testData.classes_group))])]),a("tr",[a("td",[t._v("生产机台")]),a("td",[t._v(t._s(t.testData.equip_no))]),a("td",[t._v("生产车次")]),a("td",[t._v(t._s(t.testData.actual_trains))])]),a("tr",[a("td",[t._v("收皮重量")]),a("td",[t._v(t._s(t.testData.actual_weight))]),a("td",[t._v("余量")]),a("td",[t._v(t._s(t.testData.residual_weight))])]),a("tr",[a("td",[t._v("生产时间")]),a("td",{attrs:{colspan:"3"}},[t._v(t._s(t.testData.production_factory_date))])]),a("tr",[a("td",[t._v("有效时间")]),a("td",{attrs:{colspan:"3"}},[t._v(t._s(t.testData.valid_time))])]),a("tr",[a("td",[t._v("收皮员")]),a("td",[t._v(t._s(t.testData.operation_user))]),a("td",[t._v("备注")]),a("td")]),t._m(2),a("tr",[a("td",[t._v("检测时间")]),a("td",{attrs:{colspan:"3"}},[t._v(t._s(t.testData.test?t.testData.test.test_factory_date:""))])]),a("tr",[a("td",[t._v("打印时间")]),a("td",{attrs:{colspan:"3"}},[t._v(t._s(t.testData.print_time))])]),a("tr",[a("td",[t._v("检测员")]),a("td",[t._v(t._s(t.testData.test?t.testData.test.test_user:""))]),a("td",[t._v("检测班次")]),a("td",[t._v(t._s(t.testData.test?t.testData.test.test_class:""))])]),a("tr",[a("td",[t._v("检测结果")]),a("td",[t._v(t._s(t.testData.deal_result))]),a("td",[t._v("备注")]),a("td",[t._v(t._s(t.testData.test?t.testData.test.test_note:""))])]),a("tr",[a("td",[t._v("处理人")]),a("td",[t._v(t._s(t.testData.deal_user))]),a("td",[t._v("处理时间")]),a("td",[t._v(t._s(t.testData.deal_time))])]),a("tr",[a("td",[t._v("处理意见")]),a("td",{attrs:{colspan:"3"}},[t._v(t._s(t.testData.deal_suggestion))])])])]),a("table",{attrs:{border:"2",bordercolor:"black"}},[a("tr",[a("th",{staticStyle:{width:"100px"},attrs:{rowspan:"2"}},[t._v("车次")]),t._l(t.testData.mtr_list.table_head,(function(e,s){return a("th",{key:s,staticStyle:{"min-width":"80px","max-width":"80px"},attrs:{colspan:e.length}},[t._v(t._s(s))])})),a("th",{staticStyle:{width:"100px"},attrs:{rowspan:"2"}},[t._v("综合判级")])],2),a("tr",t._l(t.testData.mtr_list.sub_head,(function(e,s){return a("th",{key:s},[t._v(t._s(e))])})),0),t._l(t.testData.mtr_list.rows,(function(e){return a("tr",{key:e},[a("td",[t._v(t._s(e))]),t._l(t.testData.mtr_list[e],(function(s,r){return a("td",{key:r},[t._v(" "+t._s(r!==t.testData.mtr_list[e].length-1?s.value:"")+" "+t._s(r!==t.testData.mtr_list[e].length-1?s.add_subtract:s.status)+" ")])}))],2)}))],2),a("img",{staticClass:"barcode"})])},C=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",{attrs:{colspan:"5"}},[t._v("胶料信息卡")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",{staticStyle:{transform:"rotate(-90deg)",width:"150px","max-width":"150px"},attrs:{rowspan:"14"}},[a("img",{staticClass:"barcode",staticStyle:{"margin-left":"-120px"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",{attrs:{colspan:"4"}},[t._v("质量信息卡")])])}],x=(a("99af"),a("7db0"),a("62c5")),S=a.n(x),P={data:function(){return{testData:{test:{},mtr_list:{table_head:[],sub_head:[],rows:[]}}}},methods:{setTestData:function(t){var e=this;this.testData=t,S()(".barcode",this.testData.lot_no,{displayValue:!0}),this.testData.mtr_list.rows=[];var a=function(t){"table_head"!==t&&"rows"!==t&&"sub_head"!==t&&function(){e.testData.mtr_list.rows.push(t);var a=[],s=function(s){e.testData.mtr_list.table_head[s].forEach((function(r){var n=e.testData.mtr_list[t].find((function(t){return t.test_indicator_name===s&&t.data_point_name===r}));a.push(n||{})}))};for(var r in e.testData.mtr_list.table_head)s(r);for(var n=0,l=null,i=0;i<a.length;i++)a[i].max_test_times>n&&(n=a[i].max_test_times,l=a[i]);l&&a.push(l),e.testData.mtr_list[t]=a}()};for(var s in this.testData.mtr_list)a(s);for(var r in this.testData.mtr_list.sub_head=[],this.testData.mtr_list.table_head)this.testData.mtr_list.sub_head=this.testData.mtr_list.sub_head.concat(this.testData.mtr_list.table_head[r])}}},k=P,$=(a("a56a"),Object(v["a"])(k,y,C,!1,null,null,null)),F=$.exports,O=a("89c6"),T=a("1f6c"),L={components:{EquipSelect:c["a"],ClassSelect:u["a"],allProductNoSelect:d["a"],Page:o["a"],TestCard:F,DealSuggestionSelect:w},data:function(){return{total:0,getParams:{page:1,day_time:i()().format("YYYY-MM-DD"),equip_no:null,classes:null,product_no:null,suggestion_desc:null},palletFeedTestList:[],listLoading:!1,dialogFormVisible:!1,formData:{valid_time:null},rules:{valid_time:[{required:!0,message:"该字段不能为空",trigger:"blur"}]},testCardDialogVisible:!1,labelPrintList:[]}},created:function(){this.getPalletFeedTest()},methods:{print:function(t){var e=this;this.testCardDialogVisible=!0,this.$nextTick((function(){e.$refs["testCard"].setTestData(t)}))},updateData:function(){var t=this;this.$refs["dataForm"].validate((function(e){e&&Object(O["a"])(t.formData.id,t.formData.valid_time).then((function(){t.dialogFormVisible=!1,t.currentChange(1),t.$notify({title:"成功",message:"修改成功",type:"success",duration:2e3})}))}))},handleEdit:function(t){var e=this;this.formData.valid_time=t.valid_time,this.formData.id=t.id,this.dialogFormVisible=!0,this.$nextTick((function(){e.$refs["dataForm"].clearValidate()}))},currentChange:function(t){this.getParams.page=t,this.getPalletFeedTest()},getPalletFeedTest:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.listLoading=!0,t.palletFeedTestList=[],e.prev=2,e.next=5,Object(O["c"])(t.getParams);case 5:a=e.sent,t.total=a.count,t.palletFeedTestList=a.results,e.next=12;break;case 10:e.prev=10,e.t0=e["catch"](2);case 12:t.listLoading=!1;case 13:case"end":return e.stop()}}),e,null,[[2,10]])})))()},dayTimeChanged:function(){this.currentChange(1)},dealSuggestionChange:function(t){this.getParams.suggestion_desc=t||null,this.currentChange(1)},equipSelected:function(){this.currentChange(1)},classSelected:function(t){this.getParams.classes=t||null,this.currentChange(1)},productBatchingChanged:function(t){this.getParams.product_no=t?t.material_no:null,this.currentChange(1)},handleSelectionChange:function(t){this.labelPrintList=t},printingFun:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,0!==t.labelPrintList.length){e.next=3;break}return e.abrupt("return");case 3:return a=[],t.labelPrintList.forEach((function(t){a.push(t.lot_no)})),e.next=7,Object(T["r"])("post",null,{data:{lot_no:a}});case 7:t.$message.success("打印任务已连接"),e.next=12;break;case 10:e.prev=10,e.t0=e["catch"](0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})))()}}},V=L,q=Object(v["a"])(V,s,r,!1,null,null,null);e["default"]=q.exports},"6d0e":function(t,e,a){},a56a:function(t,e,a){"use strict";var s=a("6d0e"),r=a.n(s);r.a}}]);