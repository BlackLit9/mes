(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7460d91c"],{"1c7e2":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"时间"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},on:{change:e.changeList},model:{value:e.getParams.start_time,callback:function(t){e.$set(e.getParams,"start_time",t)},expression:"getParams.start_time"}})],1),a("el-form-item",{attrs:{label:"订单状态"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:e.changeList},model:{value:e.getParams.status,callback:function(t){e.$set(e.getParams,"status",t)},expression:"getParams.status"}},e._l(e.options1,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"物料编码"}},[a("material-code-select",{on:{changeSelect:e.materialCodeFun}})],1),a("el-form-item",{attrs:{label:"发货类型"}},[a("deliverTypeSelect",{on:{changeSelect:e.deliverTypeSelectFun}})],1),a("el-form-item",{attrs:{label:"目的地"}},[a("destinationSelect",{on:{changeSelect:e.destinationSelectFun}})],1),a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["delivery_plan","add"],expression:"['delivery_plan', 'add']"}],on:{click:e.showCreateDialog}},[e._v("新建")])],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",fit:"","cell-style":e.cellStyle,data:e.tableData}},[a("el-table-column",{attrs:{label:"No",type:"index",align:"center"}}),a("el-table-column",{attrs:{label:"目的地",align:"center",prop:"dispatch_location_name"}}),a("el-table-column",{attrs:{label:"发货单号",align:"center",prop:"order_no"}}),a("el-table-column",{attrs:{label:"发货类型",align:"center",prop:"dispatch_type_name"}}),a("el-table-column",{attrs:{label:"物料编码",align:"center",prop:"material_name"}}),a("el-table-column",{attrs:{label:"发货数量",align:"center",prop:"need_qty"}}),a("el-table-column",{attrs:{label:"已发数量",align:"center",prop:"actual_qty"}}),a("el-table-column",{attrs:{label:"发货重量",align:"center",prop:"need_weight"}}),a("el-table-column",{attrs:{label:"已发重量",align:"center",prop:"actual_weight"}}),a("el-table-column",{attrs:{label:"订单状态",align:"center",prop:"status_name"}}),a("el-table-column",{attrs:{label:"操作",width:"134",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button-group",[2==t.row.status||4==t.row.status?a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["delivery_plan","delete"],expression:"['delivery_plan', 'delete']"}],attrs:{size:"mini"},on:{click:function(a){return e.handleClose(t.row)}}},[e._v("关闭")]):e._e(),4==t.row.status?a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["delivery_plan","change"],expression:"['delivery_plan', 'change']"}],attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.showEditDialog(t.row)}}},[e._v("编辑 ")]):e._e()],1)]}}])}),a("el-table-column",{attrs:{label:"发起人",align:"center",prop:"dispatch_user"}}),a("el-table-column",{attrs:{label:"发起时间",align:"center",prop:"start_time"}}),a("el-table-column",{attrs:{label:"完成时间",align:"center",prop:"fin_time"}})],1),a("page",{attrs:{total:e.total,"current-page":e.getParams.page},on:{currentChange:e.currentChange}}),a("el-dialog",{attrs:{title:"新建发货计划",visible:e.createDialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.createDialogVisible=t}}},[a("el-form",{ref:"Form",attrs:{rules:e.rules,"label-width":"100px",model:e.createForm}},[a("el-form-item",{attrs:{label:"目的地",prop:"dispatch_location"}},[a("destinationSelect",{ref:"destinationSelect",on:{changeSelect:e.destinationCreateForm}})],1),a("el-form-item",{attrs:{label:"发货类型",prop:"dispatch_type"}},[a("deliverTypeSelect",{ref:"deliverTypeSelect",on:{changeSelect:e.deliverTypeCreateForm}})],1),a("el-form-item",{attrs:{label:"物料编码",prop:"material"}},[a("material-code-select",{ref:"materialCodeSelect",on:{changeSelect:e.materialCreateForm}})],1),a("el-form-item",{attrs:{label:"发货数量",prop:"need_qty"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{type:"age"},model:{value:e.createForm.need_qty,callback:function(t){e.$set(e.createForm,"need_qty",e._n(t))},expression:"createForm.need_qty"}})],1),a("el-form-item",{attrs:{label:"发货重量",prop:"need_weight"}},[a("el-input-number",{attrs:{min:0,step:.01,"step-strictly":""},model:{value:e.createForm.need_weight,callback:function(t){e.$set(e.createForm,"need_weight",t)},expression:"createForm.need_weight"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.createDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleCreate()}}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"编辑发货计划",visible:e.editDialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.editDialogVisible=t}}},[a("el-form",{ref:"Form",attrs:{rules:e.rules,"label-width":"100px",model:e.editForm}},[a("el-form-item",{attrs:{label:"目的地",prop:"dispatch_location"}},[a("destinationSelect",{attrs:{"default-val":e.editForm.dispatch_location,"created-is":!0},on:{changeSelect:e.destinationEditForm}})],1),a("el-form-item",{attrs:{label:"发货类型",prop:"dispatch_type"}},[a("deliverTypeSelect",{attrs:{"default-val":e.editForm.dispatch_type,"created-is":!0},on:{changeSelect:e.deliverTypeEditForm}})],1),a("el-form-item",{attrs:{label:"发货数量",prop:"need_qty"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{type:"age"},model:{value:e.editForm.need_qty,callback:function(t){e.$set(e.editForm,"need_qty",e._n(t))},expression:"editForm.need_qty"}})],1),a("el-form-item",{attrs:{label:"发货重量",prop:"need_weight"}},[a("el-input-number",{model:{value:e.editForm.need_weight,callback:function(t){e.$set(e.editForm,"need_weight",t)},expression:"editForm.need_weight"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit()}}},[e._v("确 定")])],1)],1)],1)},i=[],r=a("f060"),n=a("ed08"),o=a("3e51"),s=a("cf45"),c=a("4cad"),d=a("19c7"),m=a("1313"),u={components:{page:o["a"],MaterialCodeSelect:c["a"],deliverTypeSelect:d["a"],destinationSelect:m["a"]},data:function(){return{tableData:[],options1:s["a"].statusList,getParams:{start_time:Object(n["b"])(),page:1},createDialogVisible:!1,createForm:{},editDialogVisible:!1,editForm:{},rules:{dispatch_location:[{required:!0,message:"不能为空",trigger:"blur"}],dispatch_type:[{required:!0,message:"不能为空",trigger:"blur"}],material:[{required:!0,message:"不能为空",trigger:"blur"}],need_qty:[{required:!0,message:"不能为空",trigger:"blur"},{type:"number",message:"请输入合法整数",trigger:"blur"}],need_weight:[{required:!0,message:"不能为空",trigger:"blur"},{type:"number",message:"请输入合法数字",trigger:"blur"}]},total:1}},created:function(){this.getTableData()},methods:{getTableData:function(){var e=this;Object(r["e"])(this.getParams).then((function(t){e.tableData=t.results,e.total=t.count}))},changeList:function(){this.getParams.page=1,this.getTableData()},materialCodeFun:function(e){this.getParams.material=e,this.getParams.page=1,this.getTableData()},deliverTypeSelectFun:function(e){this.getParams.dispatch_type=e,this.getParams.page=1,this.getTableData()},destinationSelectFun:function(e){this.getParams.dispatch_location=e,this.getParams.page=1,this.getTableData()},clearCreateForm:function(){this.$refs.destinationSelect&&(this.$refs.destinationSelect.value=""),this.$refs.deliverTypeSelect&&(this.$refs.deliverTypeSelect.value=""),this.$refs.materialCodeSelect&&(this.$refs.materialCodeSelect.value=""),this.createForm={dispatch_location:null,dispatch_type:null,material:null}},showCreateDialog:function(){var e=this;this.clearCreateForm(),this.createDialogVisible=!0,this.$nextTick((function(){e.$refs.Form.clearValidate()}))},materialCreateForm:function(e){this.createForm.material=e},deliverTypeCreateForm:function(e){this.createForm.dispatch_type=e},destinationCreateForm:function(e){this.createForm.dispatch_location=e},handleCreate:function(){var e=this;this.$refs.Form.validate((function(t){t&&Object(r["g"])(e.createForm).then((function(t){e.createDialogVisible=!1,e.$message("创建成功"),e.getParams.page=1,e.getTableData()}))}))},showEditDialog:function(e){var t=this;this.editForm=Object.assign({},e),this.editDialogVisible=!0,this.$nextTick((function(){t.$refs.Form.clearValidate()}))},destinationEditForm:function(e){this.editForm.dispatch_location=e},deliverTypeEditForm:function(e){this.editForm.dispatch_type=e},handleEdit:function(){var e=this;this.$refs.Form.validate((function(t){t&&Object(r["i"])(e.editForm,e.editForm.id).then((function(t){e.editDialogVisible=!1,e.$message("修改成功"),e.getParams.page=1,e.getTableData()}))}))},handleClose:function(e){var t=this;console.log(e.status);var a=2===e.status?"执行中":"新建";this.$confirm("此操作将关闭 "+a+" 的发货单单"+e.order_no+", 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(r["b"])(e.id).then((function(e){t.$message({type:"success",message:"操作成功!"}),t.getParams.page=1,t.getTableData()})).catch((function(){}))}))},currentChange:function(e){this.getParams.page=e,this.getTableData()},cellStyle:function(e){var t=e.row,a=e.column,l=(e.rowIndex,e.columnIndex,a.property);if(t[l]&&"status_name"===l){if("关闭"===t[l])return"color: #888888";if("新建"===t[l])return"color: #000093";if("执行中"===t[l])return"color: #F5A623";if("完成"===t[l])return"color: #7ED321";if("失败"===t[l])return"color: #FF0000"}}}},p=u,g=a("2877"),h=Object(g["a"])(p,l,i,!1,null,null,null);t["default"]=h.exports}}]);