(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-aef1f334"],{3542:function(e,r,t){},"3e51":function(e,r,t){"use strict";var a=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[t("el-pagination",{attrs:{layout:"total,prev,pager,next",total:e.total,"page-size":e.pageSize,"current-page":e._currentPage},on:{"update:currentPage":function(r){e._currentPage=r},"update:current-page":function(r){e._currentPage=r},"current-change":e.currentChange}})],1)},s=[],n=(t("a9e3"),{props:{total:{type:Number,default:0},pageSize:{type:Number,default:10},currentPage:{type:Number,default:1}},data:function(){return{}},computed:{_currentPage:{get:function(){return this.currentPage},set:function(){return 1}}},methods:{currentChange:function(e){this.$emit("currentChange",e)}}}),o=n,u=t("2877"),i=Object(u["a"])(o,a,s,!1,null,null,null);r["a"]=i.exports},5630:function(e,r,t){"use strict";t.d(r,"a",(function(){return n}));var a=t("b775"),s=t("99b1");function n(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n={url:r?s["a"].GroupUrl+r+"/":s["a"].GroupUrl,method:e};return Object.assign(n,t),Object(a["a"])(n)}},7156:function(e,r,t){var a=t("861d"),s=t("d2bb");e.exports=function(e,r,t){var n,o;return s&&"function"==typeof(n=r.constructor)&&n!==t&&a(o=n.prototype)&&o!==t.prototype&&s(e,o),e}},"9f5e":function(e,r,t){"use strict";t.r(r);var a=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"userInfo"},[t("el-form",{attrs:{inline:!0}},[t("el-form-item",{attrs:{label:"工号"}},[t("el-input",{on:{input:e.numChanged},model:{value:e.getParams.num,callback:function(r){e.$set(e.getParams,"num",e._n(r))},expression:"getParams.num"}})],1),t("el-form-item",{attrs:{label:"用户名"}},[t("el-input",{on:{input:e.numChanged},model:{value:e.getParams.username,callback:function(r){e.$set(e.getParams,"username",r)},expression:"getParams.username"}})],1),t("el-form-item",{attrs:{label:"是否使用"}},[t("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:e.numChanged},model:{value:e.getParams.is_active,callback:function(r){e.$set(e.getParams,"is_active",r)},expression:"getParams.is_active"}},e._l(e.optionsUser,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e.permissionObj.user.indexOf("add")>-1?t("el-form-item",{staticStyle:{float:"right"}},[t("el-button",{on:{click:e.showCreateUserDialog}},[e._v("新建")])],1):e._e()],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingTable,expression:"loadingTable"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[t("el-table-column",{attrs:{updated:"",upstream:"",align:"center",type:"index",label:"No",width:"50"}}),t("el-table-column",{attrs:{label:"工号"},scopedSlots:e._u([{key:"default",fn:function(r){return[e._v(" "+e._s(r.row.num?r.row.num:"--")+" ")]}}])}),t("el-table-column",{attrs:{prop:"username",label:"用户名"}}),t("el-table-column",{attrs:{prop:"use_flag",label:"使用",width:"80",formatter:e.formatter}}),t("el-table-column",{attrs:{label:"创建人"},scopedSlots:e._u([{key:"default",fn:function(r){return[e._v(" "+e._s(r.row.created_username?r.row.created_username:"--")+" ")]}}])}),t("el-table-column",{attrs:{label:"创建日期"},scopedSlots:e._u([{key:"default",fn:function(r){return[e._v(" "+e._s(r.row.created_date?r.row.created_date:"--")+" ")]}}])}),t("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button-group",[e.permissionObj.user.indexOf("change")>-1?t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.showEditUserDialog(r.row)}}},[e._v("编辑 ")]):e._e(),e.permissionObj.user.indexOf("delete")>-1?t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleUserDelete(r.row)}}},[e._v(" "+e._s(r.row.is_active?"停用":"启用")+" ")]):e._e()],1)]}}])})],1),t("page",{attrs:{total:e.count,"current-page":e.getParams.page},on:{currentChange:e.changePage}}),t("el-dialog",{staticStyle:{"min-width":"900px"},attrs:{title:e.userForm.id?"编辑用户":"新增用户",visible:e.dialogCreateUserVisible,"before-close":e.handleClose,"close-on-click-modal":!1,width:"70%"},on:{"update:visible":function(r){e.dialogCreateUserVisible=r}}},[t("el-form",{ref:"userForm",attrs:{model:e.userForm,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"用户名",prop:"username"}},[t("el-input",{attrs:{disabled:!!e.userForm.id},model:{value:e.userForm.username,callback:function(r){e.$set(e.userForm,"username",r)},expression:"userForm.username"}})],1),e.userForm.id?t("el-form-item",{attrs:{label:"修改密码",prop:"modifypassword"}},[t("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.userForm.modifypassword,callback:function(r){e.$set(e.userForm,"modifypassword",r)},expression:"userForm.modifypassword"}})],1):e._e(),e.userForm.id?e._e():t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.userForm.password,callback:function(r){e.$set(e.userForm,"password",r)},expression:"userForm.password"}})],1),t("el-form-item",{attrs:{label:"确认密码",prop:"checkPass",rules:{required:!e.userForm.id,validator:e.validatePass2,trigger:"blur"}}},[t("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.userForm.checkPass,callback:function(r){e.$set(e.userForm,"checkPass",r)},expression:"userForm.checkPass"}})],1),e.userForm.id?e._e():t("el-form-item",{attrs:{label:"工号",prop:"num"}},[t("el-input",{attrs:{error:e.userFormError.num},model:{value:e.userForm.num,callback:function(r){e.$set(e.userForm,"num",e._n(r))},expression:"userForm.num"}})],1),t("el-form-item",{attrs:{label:"角色",size:"medium"}},[t("transferRoles",{attrs:{"default-groups":e.userForm.group_extensions,groups:e.group_extensions},on:{changeTransferGroup:e.changeTransferGroup}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(r){e.dialogCreateUserVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary",loading:e.btnloading},on:{click:function(r){return e.handleCreateUser("userForm")}}},[e._v("确 定")])],1)],1)],1)},s=[],n=(t("4160"),t("c975"),t("b0c0"),t("159b"),t("5530")),o=t("c24f"),u=t("5630"),i=t("3e51"),l=t("2f62"),c=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[t("el-transfer",{attrs:{"render-content":e.renderFunc,titles:["可用 角色","选中的 角色"],data:e.groups},on:{change:e.changeTransferGroup},model:{value:e.userGroups,callback:function(r){e.userGroups=r},expression:"userGroups"}})],1)},d=[],m={props:{groups:{type:Array,default:function(){return[]}},defaultGroups:{type:Array,default:function(){return[]}}},data:function(){return{}},computed:{userGroups:{get:function(){if(this.defaultGroups.length>0)return this.defaultGroups||[]},set:function(){}}},methods:{renderFunc:function(e,r){return e("span",{attrs:{title:r.name}},[r.name])},changeTransferGroup:function(e){this.$emit("changeTransferGroup",e)}}},f=m,p=t("2877"),g=Object(p["a"])(f,c,d,!1,null,null,null),h=g.exports,b={components:{page:i["a"],transferRoles:h},data:function(){var e=this,r=function(r,t,a){t?t&&(t.length<3||t.length>16)?a(new Error("请输入3~16位长度的密码")):(""!==e.userForm.checkPass&&e.$refs.userForm.validateField("checkPass"),a()):a(new Error("请输入密码"))};this.validatePass2=function(r,t,a){e.userForm.id&&(e.userForm.modifypassword&&t!==e.userForm.modifypassword?a(new Error("两次输入密码不一致!")):a()),t?t!==e.userForm.password?a(new Error("两次输入密码不一致!")):a():a(new Error("请再次输入密码"))};var t=function(e,r,t){r?/^[a-zA-Z0-9\u4e00-\u9fa5]+$/g.test(r)?r.length>64?t(new Error("长度小于64个字符!")):r.length<2?t(new Error("请输入最少两个字符!")):t():t(new Error("用户名格式错误，请输入字母和数字组合")):t(new Error("请输入用户名!"))},a=function(e,r,t){r&&(r.length<3||r.length>16)?t(new Error("请输入3~16位长度的密码")):t()};return{isError:!1,isErrorOldPassword:!1,titleOldPassword:"",titleNewPassword:!0,btnloading:!1,getParams:{page:1,num:"",username:"",is_active:null},currentPage:1,dialogCreateUserVisible:!1,userForm:{username:"",password:"",checkPass:"",num:null,group_extensions:[]},tableData:[],count:0,rules:{password:[{required:!0,validator:r,trigger:"blur"}],modifypassword:[{validator:a,trigger:"blur"}],username:[{required:!0,validator:t,trigger:"blur"}],num:[{required:!0,message:"请填写工号",trigger:"blur"}]},group_extensions:[],loading:!0,loadingTable:!1,userFormError:{},optionsUser:[{value:1,label:"Y"},{value:0,label:"N"}]}},computed:Object(n["a"])({},Object(l["b"])(["permission"])),created:function(){var e=this;this.permissionObj=this.permission,this.loading=!0,(this.permissionObj.user.indexOf("change")>-1||this.permissionObj.user.indexOf("add")>-1)&&Object(u["a"])("get",null,{params:{all:1}}).then((function(r){var t=r.results;t.forEach((function(e){e.key=e.id,e.label=e.name})),e.group_extensions=t})).catch((function(e){})),this.currentChange()},methods:{changeUsername:function(e){this.userForm.username=e.target.value},blurUsername:function(){this.userForm.username?this.isError=!1:this.isError=!0},changeOldPassword:function(e){this.userForm.oldPassword=e.target.value},currentChange:function(){var e=this,r=this;this.loading||(this.loadingTable=!0),Object(o["b"])("get",null,{params:this.getParams}).then((function(t){e.count=t.count||0,r.tableData=t.results||[],e.loading=!1,e.loadingTable=!1})).catch((function(r){e.loading=!1,e.loadingTable=!1}))},numChanged:function(){this.getParams["page"]=1,this.currentChange()},userNameChanged:function(){},showCreateUserDialog:function(){this.clearUserForm(),this.$refs["userForm"]&&this.$refs["userForm"].resetFields(),this.dialogCreateUserVisible=!0},clearUserForm:function(){this.userForm={username:"",password:"",checkPass:"",num:null}},showEditUserDialog:function(e){this.userForm=JSON.parse(JSON.stringify(e)),this.dialogCreateUserVisible=!0},handleUserDelete:function(e){var r=e.is_active?"停用":"启用",t=this;this.$confirm("确定"+r+e.username+", 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["b"])("delete",e.id).then((function(e){t.$message({type:"success",message:"操作成功!"}),t.currentChange()})).catch((function(){}))})).catch((function(){}))},changePage:function(e){this.getParams["page"]=e,this.currentChange()},handleCreateUser:function(e){var r=this,t=this;this.$refs[e].validate((function(e){if(!e)return!1;r.btnloading=!0;var a=t.userForm.id?"put":"post",s=t.userForm.id?t.userForm.id:"";t.userForm.id&&(t.userForm.modifypassword?t.userForm.password=t.userForm.modifypassword:delete t.userForm.password),""===r.userForm.password&&delete t.userForm.password,""===r.userForm.num&&delete t.userForm.num,Object(o["b"])(a,s,{data:Object(n["a"])({},t.userForm)}).then((function(e){t.dialogCreateUserVisible=!1,t.$message.success(t.userForm.username+"操作成功"),t.currentChange(),r.btnloading=!1})).catch((function(e){r.userFormError=e,r.btnloading=!1}))}))},handleClose:function(e){this.$refs["userForm"].resetFields(),this.isError=!1,this.isErrorOldPassword=!1,e()},formatter:function(e,r){return e.is_active?"Y":"N"},changeTransferGroup:function(e){this.$set(this.userForm,"group_extensions",e)}}},v=b,w=(t("f296"),Object(p["a"])(v,a,s,!1,null,null,null));r["default"]=w.exports},a9e3:function(e,r,t){"use strict";var a=t("83ab"),s=t("da84"),n=t("94ca"),o=t("6eeb"),u=t("5135"),i=t("c6b6"),l=t("7156"),c=t("c04e"),d=t("d039"),m=t("7c73"),f=t("241c").f,p=t("06cf").f,g=t("9bf2").f,h=t("58a8").trim,b="Number",v=s[b],w=v.prototype,F=i(m(w))==b,_=function(e){var r,t,a,s,n,o,u,i,l=c(e,!1);if("string"==typeof l&&l.length>2)if(l=h(l),r=l.charCodeAt(0),43===r||45===r){if(t=l.charCodeAt(2),88===t||120===t)return NaN}else if(48===r){switch(l.charCodeAt(1)){case 66:case 98:a=2,s=49;break;case 79:case 111:a=8,s=55;break;default:return+l}for(n=l.slice(2),o=n.length,u=0;u<o;u++)if(i=n.charCodeAt(u),i<48||i>s)return NaN;return parseInt(n,a)}return+l};if(n(b,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var y,P=function(e){var r=arguments.length<1?0:e,t=this;return t instanceof P&&(F?d((function(){w.valueOf.call(t)})):i(t)!=b)?l(new v(_(r)),t,P):_(r)},E=a?f(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),k=0;E.length>k;k++)u(v,y=E[k])&&!u(P,y)&&g(P,y,p(v,y));P.prototype=w,w.constructor=P,o(s,b,P)}},f296:function(e,r,t){"use strict";var a=t("3542"),s=t.n(a);s.a}}]);