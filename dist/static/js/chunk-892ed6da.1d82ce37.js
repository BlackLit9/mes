(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-892ed6da"],{1:function(t,e){},"13d5":function(t,e,a){"use strict";var r=a("23e7"),n=a("d58f").left,o=a("a640"),i=a("ae40"),l=o("reduce"),s=i("reduce",{1:0});r({target:"Array",proto:!0,forced:!l||!s},{reduce:function(t){return n(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}})},2:function(t,e){},2342:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"product-plan-reality-analyse"},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"时间"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.getParams.factory_date,callback:function(e){t.$set(t.getParams,"factory_date",e)},expression:"getParams.factory_date"}})],1),a("el-form-item",{attrs:{label:"时间区间"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.getParams.hour_step,callback:function(e){t.$set(t.getParams,"hour_step",e)},expression:"getParams.hour_step"}},t._l(t.hourStepOptions,(function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),a("el-form-item",{attrs:{label:"班次"}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:t.getParams.classes,callback:function(e){t.$set(t.getParams,"classes",e)},expression:"getParams.classes"}},t._l(t.classOptions,(function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{on:{click:t.changeSearch}},[t._v("查询")])],1)],1),t._l(t.getParams.classes,(function(e,r){return a("el-table",{key:r,staticStyle:{width:"100%"},attrs:{data:t.tableData[e],border:"","summary-method":t.getSummaries,"show-summary":!0,"sum-text":"合计","max-height":"500"}},[a("el-table-column",{attrs:{fixed:"",label:"机台",prop:"equip_no",width:"50",align:"center"}}),a("el-table-column",{attrs:{fixed:"",label:"目标产量",prop:"plan_train_sum",width:"55",align:"center"}}),a("el-table-column",{attrs:{label:e,align:"center"}},t._l(t.headers,(function(e,r){return a("el-table-column",{key:r,attrs:{label:e+"小时",align:"center"}},[a("el-table-column",{attrs:{label:"目标","min-width":"5",align:"center",prop:e.toString()},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" "+t._s(a.row.time_span_train_count[e.toString()][0])+" ")]}}],null,!0)}),a("el-table-column",{attrs:{label:"完成","min-width":"5",align:"center",prop:e.toString()},scopedSlots:t._u([{key:"default",fn:function(r){return[r.row.time_span_train_count?a("p",{style:t.getStyle(r.row.time_span_train_count[e.toString()])},[t._v(" "+t._s(r.row.time_span_train_count[e.toString()][1])+" ")]):t._e()]}}],null,!0)})],1)})),1),a("el-table-column",{attrs:{fixed:"right",label:"未达产原因分析",width:"160",prop:"cause",align:"center"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"60",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.showEditDialog(e.row)}}},[t._v("编辑")])]}}],null,!0)})],1)})),a("el-dialog",{attrs:{title:"编辑原因",visible:t.dialogEditVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogEditVisible=e}}},[a("el-form",{attrs:{model:t.editForm}},[a("el-form-item",{attrs:{label:"机台："}},[t._v(" "+t._s(t.editForm.equip_no)+" ")]),a("el-form-item",{attrs:{label:"时间："}},[t._v(" "+t._s(t.editForm.factory_date)+" ")]),a("el-form-item",{attrs:{label:"班次："}},[t._v(" "+t._s(t.editForm.classes)+" ")]),a("el-form-item",{attrs:{"label-width":"55px",label:"原因：",prop:"cause"}},[a("el-input",{model:{value:t.editForm.cause,callback:function(e){t.$set(t.editForm,"cause",e)},expression:"editForm.cause"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogEditVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.handleEdit}},[t._v("确 定")])],1)],1)],2)},n=[],o=(a("a623"),a("4160"),a("d81d"),a("13d5"),a("a9e3"),a("159b"),a("b775")),i=a("99b1");function l(t){return Object(o["a"])({url:i["a"].ProductionPlanRealityAnalysis,method:"get",params:t})}function s(t){return Object(o["a"])({url:i["a"].UpdateCause,method:"put",data:t})}var c=a("ed08"),u={data:function(){return{formLabelWidth:"auto",getParams:{factory_date:Object(c["e"])(),hour_step:2,classes:["早班"]},headers:[],tableData:{},classOptions:["早班","夜班"],hourStepOptions:[1,2,3,4,6,12],editForm:{},dialogEditVisible:!1}},created:function(){this.getTableData()},methods:{getTableData:function(){var t=this;this.headers=[],l(this.getParams).then((function(e){t.tableData=e,t.headers=e.headers}))},changeSearch:function(){this.getTableData()},showEditDialog:function(t){this.editForm={factory_date:t.factory_date,classes:t.classes,equip_no:t.equip_no,cause:t.cause},this.dialogEditVisible=!0},handleEdit:function(){var t=this;s(this.editForm).then((function(e){t.dialogEditVisible=!1,t.$message("修改成功"),t.getTableData()}))},getSummaries:function(t){var e=t.columns,a=t.data,r=[];return e.forEach((function(t,e){var n=null;0!==e?("目标"===t.label&&(n=a.map((function(e){return Number(e.time_span_train_count[t.property][0])}))),"完成"===t.label&&(n=a.map((function(e){return Number(e.time_span_train_count[t.property][1])}))),"完成"!==t.label&&"目标"!==t.label&&(n=a.map((function(e){return Number(e[t.property])}))),"未达产原因分析"!==t.label?n.every((function(t){return isNaN(t)}))?r[e]="":(r[e]=n.reduce((function(t,e){var a=Number(e);return isNaN(a)?t:t+e}),0),r[e]+=""):r[e]=""):r[e]="合计"})),r},getStyle:function(t){if(t[1]<t[0])return"height:100%; margin:0 0 0 0; background-color: #EA1B29; color: #F5F7FA"}}},d=u,f=(a("472f"),a("2877")),m=Object(f["a"])(d,r,n,!1,null,null,null);e["default"]=m.exports},3:function(t,e){},"472f":function(t,e,a){"use strict";var r=a("f32a"),n=a.n(r);n.a},a623:function(t,e,a){"use strict";var r=a("23e7"),n=a("b727").every,o=a("a640"),i=a("ae40"),l=o("every"),s=i("every");r({target:"Array",proto:!0,forced:!l||!s},{every:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}})},d58f:function(t,e,a){var r=a("1c0b"),n=a("7b0b"),o=a("44ad"),i=a("50c4"),l=function(t){return function(e,a,l,s){r(a);var c=n(e),u=o(c),d=i(c.length),f=t?d-1:0,m=t?-1:1;if(l<2)while(1){if(f in u){s=u[f],f+=m;break}if(f+=m,t?f<0:d<=f)throw TypeError("Reduce of empty array with no initial value")}for(;t?f>=0:d>f;f+=m)f in u&&(s=a(s,u[f],f,c));return s}};t.exports={left:l(!1),right:l(!0)}},ed08:function(t,e,a){"use strict";a.d(e,"e",(function(){return c})),a.d(e,"b",(function(){return d})),a.d(e,"a",(function(){return f})),a.d(e,"d",(function(){return m})),a.d(e,"c",(function(){return b}));a("4160"),a("caad"),a("c975"),a("45fc"),a("a9e3"),a("b64b"),a("d3b7"),a("4d63"),a("ac1f"),a("25f0"),a("2532"),a("4d90"),a("5319"),a("1276"),a("159b");var r=a("53ca"),n=a("4360"),o=a("ecc0"),i=a.n(o),l=a("1146"),s=a.n(l);function c(t,e,a){var r=t?new Date(t):new Date,n={y:r.getFullYear(),m:u(r.getMonth()+1),d:u(r.getDate()),h:u(r.getHours()),i:u(r.getMinutes()),s:u(r.getSeconds()),a:u(r.getDay())};return e?n.y+"-"+n.m+"-"+n.d+" "+n.h+":"+n.i+":"+n.s:a&&"continuation"===a?n.y+n.m+n.d+n.h+n.i+n.s:n.y+"-"+n.m+"-"+n.d}function u(t){return t=Number(t),t<10?"0"+t:t}function d(t){if(!t&&"object"!==Object(r["a"])(t))throw new Error("error arguments","deepClone");var e=t.constructor===Array?[]:{};return Object.keys(t).forEach((function(a){t[a]&&"object"===Object(r["a"])(t[a])?e[a]=d(t[a]):e[a]=t[a]})),e}function f(t){if(t&&t instanceof Array&&t.length>0){var e=n["a"].getters&&n["a"].getters.permission,a=e[t[0]];if(!a||0===a.length)return;var r=a.some((function(e){return e===t[1]}));return r}return console.error("need roles! Like v-permission=\"['admin','editor']\""),!1}function m(t){var e=s.a.utils.table_to_book(document.querySelector("#out-table"),{raw:!0}),a=s.a.write(e,{bookType:"xlsx",bookSST:!0,type:"array"});try{i.a.saveAs(new Blob([a],{type:"application/octet-stream"}),t+".xlsx")}catch(r){"undefined"!==typeof console&&console.log(r,a)}return a}function b(t,e){if(t.$message.closeAll(),"[object Object]"===Object.prototype.toString.call(e)){var a="";for(var r in e)console.log(e[r]),e[r].forEach((function(t){a+=t}));a.includes("已存在")&&t.$message.error("已存在!")}}},f32a:function(t,e,a){}}]);