(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-981afe8a"],{5324:function(e,t,a){},"64dc":function(e,t,a){"use strict";a.d(t,"l",(function(){return i})),a.d(t,"j",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"h",(function(){return s})),a.d(t,"e",(function(){return u})),a.d(t,"a",(function(){return c})),a.d(t,"i",(function(){return d})),a.d(t,"f",(function(){return h})),a.d(t,"k",(function(){return m})),a.d(t,"c",(function(){return b})),a.d(t,"g",(function(){return p})),a.d(t,"d",(function(){return f}));var r=a("b775"),n=a("99b1");function i(){return Object(r["a"])({url:n["a"].WarehouseNamesUrl,method:"get"})}function o(e){return Object(r["a"])({url:n["a"].WarehouseInfoUrl,method:"get",params:e})}function l(e,t,a){return Object(r["a"])({url:t?n["a"].WarehouseInfoUrl+t+"/":n["a"].WarehouseInfoUrl,method:e,data:a})}function s(e){return Object(r["a"])({url:n["a"].WarehouseInfoUrl+e+"/reversal_use_flag/",method:"put"})}function u(e){return Object(r["a"])({url:n["a"].StationInfoUrl,method:"get",params:e})}function c(e,t,a){return Object(r["a"])({url:t?n["a"].StationInfoUrl+t+"/":n["a"].StationInfoUrl,method:e,data:a})}function d(e){return Object(r["a"])({url:n["a"].StationInfoUrl+e+"/reversal_use_flag/",method:"put"})}function h(){return Object(r["a"])({url:n["a"].StationTypesUrl,methods:"get"})}function m(e){return Object(r["a"])({url:n["a"].WarehouseMaterialTypeUrl,method:"get",params:e})}function b(e,t,a){return Object(r["a"])({url:t?n["a"].WarehouseMaterialTypeUrl+t+"/":n["a"].WarehouseMaterialTypeUrl,method:e,data:a})}function p(e){return Object(r["a"])({url:n["a"].WarehouseMaterialTypeUrl+e+"/reversal_use_flag/",method:"put"})}function f(){return Object(r["a"])({url:n["a"].MaterialTypesUrl,methods:"get"})}},d13c:function(e,t,a){"use strict";var r=a("5324"),n=a.n(r);n.a},fffe:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"warehousing"},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"物料类型:"}},[a("materialTypeSelect",{on:{changeSelect:e.changeMaterialType}})],1),a("el-form-item",{attrs:{label:"物料编码:"}},[a("materialCodeSelect",{attrs:{"is-all-obj":!0,"label-name":"no"},on:{changeSelect:e.changeMaterialCode}})],1),a("el-form-item",{attrs:{label:"物料名称:"}},[a("materialCodeSelect",{attrs:{"is-all-obj":!0},on:{changeSelect:e.changeMaterialName}})],1),a("el-form-item",{attrs:{label:"库存位:"}},[a("inventoryPosition",{on:{changSelect:e.changeInventoryPosition}})],1),a("el-form-item",{directives:[{name:"permission",rawName:"v-permission",value:["spare_inbound","add"],expression:"['spare_inbound','add']"}]},[a("el-button",{on:{click:function(t){return e.edit(null)}}},[e._v("新增")])],1)],1),a("el-table",{attrs:{data:e.tableData,border:"","row-class-name":e.tableRowClassName}},[a("el-table-column",{attrs:{type:"index",width:"50",label:"No"}}),a("el-table-column",{attrs:{prop:"type_name",label:"物料类型"}}),a("el-table-column",{attrs:{prop:"spare_no",label:"物料编码"}}),a("el-table-column",{attrs:{prop:"spare_name",label:"物料名称"}}),a("el-table-column",{attrs:{prop:"location_name",label:"库存位"}}),a("el-table-column",{attrs:{prop:"qty",label:"数量"}}),a("el-table-column",{attrs:{prop:"unit",label:"单位"}}),e.checkPermission(["spare_inbound","price"])?a("el-table-column",{attrs:{prop:"cost",label:"单价（元）"}}):e._e(),e.checkPermission(["spare_inbound","price"])?a("el-table-column",{attrs:{prop:"total_count",label:"总价（元）"}}):e._e(),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button-group",[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["spare_inbound","inbound"],expression:"['spare_inbound','inbound']"}],attrs:{size:"mini"},on:{click:function(a){return e.edit(t.row)}}},[e._v("入库 ")]),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["spare_inbound","history"],expression:"['spare_inbound','history']"}],attrs:{size:"mini",type:"blue"},on:{click:function(a){return e.view(t.row)}}},[e._v("查看履历 ")])],1)]}}])})],1),a("page",{attrs:{"old-page":!1,total:e.total,"current-page":e.search.page},on:{currentChange:e.currentChange}}),a("el-dialog",{attrs:{title:e.currentRow.id?"入库":"新增",visible:e.dialogVisible,width:"50%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"ruleForm",attrs:{model:e.currentRow,rules:e.rules,"label-width":"100px"}},[e.currentRow.id?e._e():a("el-form-item",{attrs:{label:"仓库"}},[a("warehouseSelect",{attrs:{"created-is":!0},on:{changSelect:e.changWarehouse}})],1),a("el-form-item",{attrs:{label:"物料编码",prop:"spare"}},[a("materialCodeSelect",{attrs:{"created-is":!0,"is-all-obj":!0,"default-val":e.currentRow.spare,"is-disabled":!!e.currentRow.id,"label-name":"no"},on:{changeSelect:e.dialogMaterialFun}})],1),a("el-form-item",{attrs:{label:"物料名称",prop:"b"}},[a("materialCodeSelect",{attrs:{"created-is":!0,"is-all-obj":!0,"default-val":e.currentRow.spare,"is-disabled":!!e.currentRow.id},on:{changeSelect:e.dialogMaterialFun}})],1),a("el-form-item",{attrs:{label:"库存位"}},[a("inventoryPosition",{ref:"inventoryPosition",attrs:{"created-is":!0,"default-val":e.currentRow.location,"is-disabled":!!e.currentRow.id,"is-binding":!0,"material-no":e.currentRow.materialNo,"material-name":e.currentRow.b},on:{changSelect:e.dialogInventoryPosition}})],1),a("el-form-item",{attrs:{label:"数量",prop:"qty"}},[a("el-input-number",{attrs:{"controls-position":"right",min:1},model:{value:e.currentRow.qty,callback:function(t){e.$set(e.currentRow,"qty",t)},expression:"currentRow.qty"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.handleClose(null)}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitFun}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"备品备件入库履历",visible:e.dialogVisibleResume,width:"90%"},on:{"update:visible":function(t){e.dialogVisibleResume=t}}},[a("allRecord",{attrs:{"is-dialog":!0,show:e.dialogVisibleResume,"dialog-obj":e.dialogObj}})],1)],1)},n=[],i=(a("053b"),a("e35a"),a("9cf3"),a("6a61"),a("cf7f")),o=a("8041"),l=a("5c1c"),s=a("a0e0"),u=a("ccc6"),c=a("3e51"),d=a("d585"),h=a("2f91"),m=a("ed08"),b={components:{materialTypeSelect:s["a"],allRecord:h["default"],page:c["a"],inventoryPosition:o["a"],materialCodeSelect:l["a"],warehouseSelect:u["a"]},data:function(){return{search:{page:1,page_size:10},tableData:[],dialogVisible:!1,dialogVisibleResume:!1,currentRow:{},dialogObj:{},total:0,warehouse_info:"",loading:!1,rules:{spare:[{required:!0,message:"请输入物料编码",trigger:"change"}],b:[{required:!0,message:"请输入物料名称",trigger:"change"}],qty:[{required:!0,message:"请输入",trigger:"blur"}]}}},created:function(){this.getList();var e=this;document.onkeydown=function(t){var a=t||a;!0===e.dialogVisible&&13===a.keyCode&&e.submitFun()}},methods:{checkPermission:m["a"],getList:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,t.next=4,Object(d["k"])("get",null,{params:e.search});case 4:a=t.sent,e.tableData=a.results,e.total=a.count,t.next=11;break;case 9:t.prev=9,t.t0=t["catch"](0);case 11:e.loading=!1;case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},changeInventoryPosition:function(e){this.search.location_name=e?e.name:null,this.search.page=1,this.getList()},changeMaterialCode:function(e){this.search.spare_no=e?e.no:null,this.search.page=1,this.getList()},changeMaterialType:function(e){this.search.type_name=e?e.name:null,this.search.page=1,this.getList()},changeMaterialName:function(e){this.search.spare_name=e?e.name:null,this.search.page=1,this.getList()},edit:function(e){e?(this.currentRow=JSON.parse(JSON.stringify(e)),this.currentRow.b=e.spare_name,this.currentRow.qty=1):(this.currentRow={},this.currentRow.warehouse_info=this.warehouse_info,this.currentRow.location=null),this.dialogVisible=!0},view:function(e){this.dialogVisibleResume=!0,this.dialogObj=e},handleClose:function(e){var t=this;setTimeout((function(){t.currentRow={},t.$refs.ruleForm.resetFields()}),300),this.dialogVisible=!1,e&&e()},submitFun:function(){var e=this;this.$refs.ruleForm.validate(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=19;break}if(t.prev=1,e.currentRow.id){t.next=8;break}return t.next=5,Object(d["k"])("post",null,{data:e.currentRow});case 5:e.$message.success("添加成功"),t.next=11;break;case 8:return t.next=10,Object(d["i"])("post",e.currentRow.id,{data:{qty:e.currentRow.qty}});case 10:e.$message.success("入库成功");case 11:e.handleClose(null),e.getList(),t.next=17;break;case 15:t.prev=15,t.t0=t["catch"](1);case 17:t.next=20;break;case 19:return t.abrupt("return",!1);case 20:case"end":return t.stop()}}),t,null,[[1,15]])})));return function(e){return t.apply(this,arguments)}}())},dialogMaterialFun:function(e){this.$set(this.currentRow,"b",e?e.name:null),this.$set(this.currentRow,"spare",e?e.id:null),this.$set(this.currentRow,"materialNo",e?e.no:null),this.$refs.inventoryPosition.value=null,this.currentRow.location=null},changWarehouse:function(e){this.warehouse_info=e.id||null,this.$set(this.currentRow,"warehouse_info",e?e.id:null)},dialogInventoryPosition:function(e){this.$set(this.currentRow,"location",e?e.location:"")},currentChange:function(e,t){this.search.page=e,this.search.page_size=t,this.getList()},tableRowClassName:function(e){var t=e.row;e.rowIndex;return"-"===t.bound?"warning-row":"+"===t.bound?"max-warning-row":""}}},p=b,f=(a("d13c"),a("9ca4")),g=Object(f["a"])(p,r,n,!1,null,null,null);t["default"]=g.exports}}]);