(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0cbaf1"],{"4b5b":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"日期"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},on:{change:e.dayTimeChanged},model:{value:e.getParams.day_time,callback:function(t){e.$set(e.getParams,"day_time",t)},expression:"getParams.day_time"}})],1),a("el-form-item",{attrs:{label:"机台"}},[a("equip-select",{on:{equipSelected:e.equipSelected}})],1),a("el-form-item",{attrs:{label:"班次"}},[a("class-select",{on:{classSelected:e.classSelected}})],1),a("el-form-item",{attrs:{label:"胶料"}},[a("product-no-select",{attrs:{"is-stage-productbatch-no-remove":!0,"make-use-batch":!0},on:{productBatchingChanged:e.productBatchingChanged}})],1),a("el-form-item",{attrs:{label:"综合处理意见"}}),a("el-form-item",[a("el-button",{on:{click:function(t){e.filterDialogVisible=!0}}},[e._v(" 显示过滤界面 ")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.testOrders,border:"",fit:"","row-key":"index","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"}}},[e._v(" > "),a("el-table-column",{attrs:{label:"No",align:"center",prop:"index"}}),a("el-table-column",{attrs:{label:"生产信息",align:"center"}},[a("el-table-column",{attrs:{label:"生产计划号",width:"95",prop:"plan_classes_uid"}}),a("el-table-column",{attrs:{label:"收皮条码",prop:"lot_no"}}),a("el-table-column",{attrs:{label:"生产班次/班组",width:"110",prop:"class_group"}}),a("el-table-column",{attrs:{label:"生产机台",prop:"production_equip_no"}}),a("el-table-column",{attrs:{label:"胶料编码",align:"center",width:"150",prop:"product_no"}}),a("el-table-column",{attrs:{label:"车次",width:"50",align:"center",prop:"actual_trains"}}),a("el-table-column",{attrs:{label:"检测状态",prop:"test_status"}})],1),e._l(e.testTypeList.filter((function(e){return e.show})),(function(t){return a("el-table-column",{key:t.test_type_name,attrs:{align:"center",label:t.test_type_name}},[e._l(t.data_indicator_detail.filter((function(e){return e.show})),(function(l){return a("el-table-column",{key:t.test_type_name+l.detail,attrs:{width:"110",label:l.detail,align:"center"}},[a("el-table-column",{attrs:{label:"检测次数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.row;return[e._v(" "+e._s(e.getDataPoint(t.test_type_name,l.detail,r.order_results,"test_times"))+" ")]}}],null,!0)}),a("el-table-column",{attrs:{label:"检测值",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.row;return[e._v(" "+e._s(e.getDataPoint(t.test_type_name,l.detail,r.order_results,"value"))+" ")]}}],null,!0)}),a("el-table-column",{attrs:{label:"等级",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.row;return[e._v(" "+e._s(e.getDataPoint(t.test_type_name,l.detail,r.order_results,"level"))+" ")]}}],null,!0)})],1)})),a("el-table-column",{attrs:{label:"等级",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){e.row}}],null,!0)})],2)})),a("el-table-column",{attrs:{label:"综合等级",prop:"maxLevel"}}),a("el-table-column",{attrs:{label:"综合检测结果",width:"110",prop:"mes_result"}})],2),a("el-dialog",{attrs:{title:"选择过滤",visible:e.filterDialogVisible},on:{"update:visible":function(t){e.filterDialogVisible=t}}},[a("el-table",{attrs:{border:"",data:e.testTypeList}},[a("el-table-column",{attrs:{label:"选择",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-checkbox",{model:{value:l.show,callback:function(t){e.$set(l,"show",t)},expression:"row.show"}})]}}])}),a("el-table-column",{attrs:{label:"实验方法",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("span",[e._v(e._s(l.test_type_name))])]}}])}),a("el-table-column",{attrs:{label:"检测项"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[e._l(l.data_indicator_detail,(function(t){return[a("el-checkbox",{key:t.detail,model:{value:t.show,callback:function(a){e.$set(t,"show",a)},expression:"item.show"}},[e._v(e._s(t.detail))])]}))]}}])})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.filterDialogVisible=!1}}},[e._v("关闭")])],1)],1),a("el-dialog",{attrs:{title:"胶料信息卡",width:"80%",visible:e.testCardDialogVisible},on:{"update:visible":function(t){e.testCardDialogVisible=t}}},[a("test-card",{ref:"testCard"})],1)],1)},r=[],n=(a("99af"),a("4de4"),a("4160"),a("d81d"),a("13d5"),a("159b"),a("5530")),s=(a("96cf"),a("1da1")),i=a("5a0c"),o=a.n(i),c=a("34be"),u=a("8448"),d=a("cfc4"),p=a("1c2f"),_=a("1b10"),f=a("89c6"),b={components:{PlanSchedulesSelect:c["a"],EquipSelect:u["a"],ClassSelect:d["a"],ProductNoSelect:p["a"],TestCard:_["a"]},data:function(){return{getParams:{day_time:o()().format("YYYY-MM-DD"),equip_no:null,classes:null,product_no:null},listLoading:!0,filterDialogVisible:!1,testCardDialogVisible:!1,testTypeList:[{test_type_id:null,test_type_name:"",show:!1,data_indicator_detail:[{detail:"",show:!1}]}],testOrders:[]}},created:function(){this.getTestTypes(),this.getMaterialTestOrders()},methods:{dayTimeChanged:function(){this.getMaterialTestOrders()},equipSelected:function(e){this.getParams.equip_no=e?e.equip_no:null,this.getMaterialTestOrders()},classSelected:function(e){this.getParams.classes=e||null,this.getMaterialTestOrders()},productBatchingChanged:function(e){this.getParams.product_no=e?e.stage_product_batch_no:null,this.getMaterialTestOrders()},matchedTestData:function(e,t,a){var l=null,r=e.order_results.filter((function(e){return e.test_indicator_name===t.test_type_name})).filter((function(e){return e.data_point_name===a.detail}));r.length>0&&(l=r.reduce((function(e,t){return e.test_times>t.test_times?e:t}),[]),r.sort((function(e,t){t.test_times,e.test_times})));var n=[l,r];return n},getMaterialTestOrders:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,l,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.listLoading=!0,t.prev=1,t.next=4,Object(f["b"])(e.getParams);case 4:a=t.sent,l=a.map((function(e){return Object(n["a"])(Object(n["a"])({},e),{},{class_group:"".concat(e.production_class,"/").concat(e.production_group)})})),r=1,s=[],l.forEach((function(e){for(var t in e.order_results)for(var a in e.order_results[t]){e.index=r++;var l=Object.assign({},e);l.order_results={},l.order_results[t]={},l.order_results[t][a]=e.order_results[t][a][0],s.push(l)}})),e.testOrders=s,console.log(e.testOrders),t.next=15;break;case 13:t.prev=13,t.t0=t["catch"](1);case 15:e.listLoading=!1,console.log(e.testOrders,"this.testOrders");case 17:case"end":return t.stop()}}),t,null,[[1,13]])})))()},getTestTypes:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.testTypeList=[],t.next=4,Object(f["d"])();case 4:a=t.sent,e.testTypeList=a.map((function(e){return e.data_indicator_detail=e.data_indicator_detail.map((function(e){return{detail:e,show:!0}})),Object(n["a"])(Object(n["a"])({},e),{},{show:!0})})),t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](0);case 10:case"end":return t.stop()}}),t,null,[[0,8]])})))()},showCard:function(e){var t=this;this.testCardDialogVisible=!0,this.$nextTick((function(){t.$refs["testCard"].setTestData(e)}))},getDataPoint:function(e,t,a,l){var r=a[e]&&a[e][t]?a[e][t]:null;return r?r[l]:""}}},m=b,h=a("2877"),g=Object(h["a"])(m,l,r,!1,null,null,null);t["default"]=g.exports}}]);